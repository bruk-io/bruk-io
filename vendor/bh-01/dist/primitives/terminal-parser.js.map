{"version":3,"file":"terminal-parser.js","sources":["../../src/primitives/terminal-parser.ts"],"sourcesContent":["/**\n * Terminal text parser — converts color tag syntax into HTML spans\n * using bh-01 semantic color tokens.\n *\n * Syntax: {primary}colored text{/}\n */\n\n/** Maps tag names to CSS class names */\nexport const TERMINAL_TAG_MAP: Record<string, string> = {\n  primary: 'bh-t-primary',\n  success: 'bh-t-success',\n  warning: 'bh-t-warning',\n  danger: 'bh-t-danger',\n  text: 'bh-t-text',\n  bright: 'bh-t-bright',\n  muted: 'bh-t-muted',\n  tertiary: 'bh-t-tertiary',\n  bold: 'bh-t-bold',\n};\n\n/**\n * Escape HTML entities while preserving curly braces used for tag syntax.\n */\nexport function escapeTerminalHtml(text: string): string {\n  return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n}\n\n/**\n * Convert {tag}text{/} syntax to <span class=\"...\">text</span>.\n * Unknown tags are left as literal text. Unclosed tags are still\n * converted to spans (the browser will close them implicitly).\n */\nexport function parseColorTags(text: string): string {\n  return text.replace(/\\{(\\/?[a-zA-Z]*)\\}/g, (_match, tag: string) => {\n    if (tag === '/') {\n      return '</span>';\n    }\n    const className = TERMINAL_TAG_MAP[tag];\n    if (className) {\n      return `<span class=\"${className}\">`;\n    }\n    // Unknown tag — return the original text unchanged\n    return `{${tag}}`;\n  });\n}\n\nconst URL_REGEX = /https?:\\/\\/[^\\s<>\"']+/g;\n\n/**\n * Detect http/https URLs in text and wrap them in anchor tags.\n */\nexport function linkifyUrls(html: string): string {\n  return html.replace(URL_REGEX, (url) => {\n    return `<a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer\" part=\"link\">${url}</a>`;\n  });\n}\n\n/**\n * Full rendering pipeline: escape HTML → parse color tags → linkify URLs.\n */\nexport function renderTerminalText(text: string): string {\n  const escaped = escapeTerminalHtml(text);\n  const parsed = parseColorTags(escaped);\n  return linkifyUrls(parsed);\n}\n"],"names":["TERMINAL_TAG_MAP","escapeTerminalHtml","text","parseColorTags","_match","tag","className","URL_REGEX","linkifyUrls","html","url","renderTerminalText","escaped","parsed"],"mappings":"AAQO,MAAMA,IAA2C;AAAA,EACtD,SAAS;AAAA,EACT,SAAS;AAAA,EACT,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,UAAU;AAAA,EACV,MAAM;AACR;AAKO,SAASC,EAAmBC,GAAsB;AACvD,SAAOA,EAAK,QAAQ,MAAM,OAAO,EAAE,QAAQ,MAAM,MAAM,EAAE,QAAQ,MAAM,MAAM;AAC/E;AAOO,SAASC,EAAeD,GAAsB;AACnD,SAAOA,EAAK,QAAQ,uBAAuB,CAACE,GAAQC,MAAgB;AAClE,QAAIA,MAAQ;AACV,aAAO;AAET,UAAMC,IAAYN,EAAiBK,CAAG;AACtC,WAAIC,IACK,gBAAgBA,CAAS,OAG3B,IAAID,CAAG;AAAA,EAChB,CAAC;AACH;AAEA,MAAME,IAAY;AAKX,SAASC,EAAYC,GAAsB;AAChD,SAAOA,EAAK,QAAQF,GAAW,CAACG,MACvB,YAAYA,CAAG,2DAA2DA,CAAG,MACrF;AACH;AAKO,SAASC,EAAmBT,GAAsB;AACvD,QAAMU,IAAUX,EAAmBC,CAAI,GACjCW,IAASV,EAAeS,CAAO;AACrC,SAAOJ,EAAYK,CAAM;AAC3B;"}