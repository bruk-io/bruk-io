{"version":3,"file":"pixel-font.js","sources":["../../src/primitives/pixel-font.ts"],"sourcesContent":["/**\n * 3×5 bitmap pixel font.\n *\n * Each glyph is 5 rows of 3-bit values (0–7), where set bits map to lit pixels.\n * Row 0 is the top. Bit 2 = left, bit 1 = center, bit 0 = right.\n *\n * Example: \"A\" = [0b010, 0b101, 0b111, 0b101, 0b101]\n */\n\n/** Glyph lookup — uppercase A-Z, 0-9, space, and common symbols. */\nexport const PIXEL_FONT: Record<string, number[]> = {\n  A: [0b010, 0b101, 0b111, 0b101, 0b101],\n  B: [0b110, 0b101, 0b110, 0b101, 0b110],\n  C: [0b011, 0b100, 0b100, 0b100, 0b011],\n  D: [0b110, 0b101, 0b101, 0b101, 0b110],\n  E: [0b111, 0b100, 0b110, 0b100, 0b111],\n  F: [0b111, 0b100, 0b110, 0b100, 0b100],\n  G: [0b011, 0b100, 0b101, 0b101, 0b011],\n  H: [0b101, 0b101, 0b111, 0b101, 0b101],\n  I: [0b111, 0b010, 0b010, 0b010, 0b111],\n  J: [0b001, 0b001, 0b001, 0b101, 0b010],\n  K: [0b101, 0b101, 0b110, 0b101, 0b101],\n  L: [0b100, 0b100, 0b100, 0b100, 0b111],\n  M: [0b101, 0b111, 0b101, 0b101, 0b101],\n  N: [0b101, 0b111, 0b111, 0b101, 0b101],\n  O: [0b010, 0b101, 0b101, 0b101, 0b010],\n  P: [0b110, 0b101, 0b110, 0b100, 0b100],\n  Q: [0b010, 0b101, 0b101, 0b111, 0b011],\n  R: [0b110, 0b101, 0b110, 0b101, 0b101],\n  S: [0b011, 0b100, 0b010, 0b001, 0b110],\n  T: [0b111, 0b010, 0b010, 0b010, 0b010],\n  U: [0b101, 0b101, 0b101, 0b101, 0b010],\n  V: [0b101, 0b101, 0b101, 0b010, 0b010],\n  W: [0b101, 0b101, 0b101, 0b111, 0b101],\n  X: [0b101, 0b101, 0b010, 0b101, 0b101],\n  Y: [0b101, 0b101, 0b010, 0b010, 0b010],\n  Z: [0b111, 0b001, 0b010, 0b100, 0b111],\n\n  '0': [0b111, 0b101, 0b101, 0b101, 0b111],\n  '1': [0b010, 0b110, 0b010, 0b010, 0b111],\n  '2': [0b110, 0b001, 0b010, 0b100, 0b111],\n  '3': [0b110, 0b001, 0b010, 0b001, 0b110],\n  '4': [0b101, 0b101, 0b111, 0b001, 0b001],\n  '5': [0b111, 0b100, 0b110, 0b001, 0b110],\n  '6': [0b011, 0b100, 0b111, 0b101, 0b111],\n  '7': [0b111, 0b001, 0b010, 0b010, 0b010],\n  '8': [0b111, 0b101, 0b010, 0b101, 0b111],\n  '9': [0b111, 0b101, 0b111, 0b001, 0b110],\n\n  ' ': [0b000, 0b000, 0b000, 0b000, 0b000],\n  ':': [0b000, 0b010, 0b000, 0b010, 0b000],\n  '.': [0b000, 0b000, 0b000, 0b000, 0b010],\n  '%': [0b101, 0b001, 0b010, 0b100, 0b101],\n  '/': [0b001, 0b001, 0b010, 0b100, 0b100],\n  '-': [0b000, 0b000, 0b111, 0b000, 0b000],\n  '!': [0b010, 0b010, 0b010, 0b000, 0b010],\n  '+': [0b000, 0b010, 0b111, 0b010, 0b000],\n};\n\n/**\n * Render text into a flat row-major pixel grid.\n *\n * Characters are laid out left-to-right with 1 column of spacing between glyphs.\n * Unknown characters are skipped. Text is uppercased automatically.\n *\n * @param text - The string to render\n * @param cols - Grid width in pixels\n * @param rows - Grid height in pixels (must be >= 5 for the font)\n * @param color - Palette index for lit pixels (default 1 = primary)\n * @returns Flat `Uint8Array` of length `cols * rows`\n */\nexport function textToGrid(\n  text: string,\n  cols: number,\n  rows: number,\n  color: number = 1,\n): Uint8Array {\n  const grid = new Uint8Array(cols * rows);\n  const upper = text.toUpperCase();\n  const glyphH = 5;\n  const glyphW = 3;\n  const spacing = 1;\n\n  // Vertical centering\n  const yOffset = Math.max(0, Math.floor((rows - glyphH) / 2));\n\n  let cursor = 0;\n  for (const char of upper) {\n    const glyph = PIXEL_FONT[char];\n    if (!glyph) continue;\n\n    for (let row = 0; row < glyphH; row++) {\n      const bits = glyph[row];\n      for (let col = 0; col < glyphW; col++) {\n        const bit = (bits >> (glyphW - 1 - col)) & 1;\n        if (bit) {\n          const px = cursor + col;\n          const py = yOffset + row;\n          if (px < cols && py < rows) {\n            grid[py * cols + px] = color;\n          }\n        }\n      }\n    }\n    cursor += glyphW + spacing;\n    if (cursor >= cols) break;\n  }\n\n  return grid;\n}\n"],"names":["PIXEL_FONT","textToGrid","text","cols","rows","color","grid","upper","glyphH","glyphW","spacing","yOffset","cursor","char","glyph","row","bits","col","px","py"],"mappings":"AAUO,MAAMA,IAAuC;AAAA,EAClD,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACrC,GAAG,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EAErC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,GAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EAEvC,KAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,KAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,KAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,KAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,KAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,KAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,KAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AAAA,EACvC,KAAK,CAAC,GAAO,GAAO,GAAO,GAAO,CAAK;AACzC;AAcO,SAASC,EACdC,GACAC,GACAC,GACAC,IAAgB,GACJ;AACZ,QAAMC,IAAO,IAAI,WAAWH,IAAOC,CAAI,GACjCG,IAAQL,EAAK,YAAA,GACbM,IAAS,GACTC,IAAS,GACTC,IAAU,GAGVC,IAAU,KAAK,IAAI,GAAG,KAAK,OAAOP,IAAOI,KAAU,CAAC,CAAC;AAE3D,MAAII,IAAS;AACb,aAAWC,KAAQN,GAAO;AACxB,UAAMO,IAAQd,EAAWa,CAAI;AAC7B,QAAKC,GAEL;AAAA,eAASC,IAAM,GAAGA,IAAMP,GAAQO,KAAO;AACrC,cAAMC,IAAOF,EAAMC,CAAG;AACtB,iBAASE,IAAM,GAAGA,IAAMR,GAAQQ;AAE9B,cADaD,KAASP,IAAS,IAAIQ,IAAQ,GAClC;AACP,kBAAMC,IAAKN,IAASK,GACdE,IAAKR,IAAUI;AACrB,YAAIG,IAAKf,KAAQgB,IAAKf,MACpBE,EAAKa,IAAKhB,IAAOe,CAAE,IAAIb;AAAA,UAE3B;AAAA,MAEJ;AAEA,UADAO,KAAUH,IAASC,GACfE,KAAUT,EAAM;AAAA;AAAA,EACtB;AAEA,SAAOG;AACT;"}