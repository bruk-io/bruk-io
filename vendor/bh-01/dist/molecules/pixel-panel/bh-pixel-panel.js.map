{"version":3,"file":"bh-pixel-panel.js","sources":["../../../src/molecules/pixel-panel/bh-pixel-panel.ts"],"sourcesContent":["import { html, css, type PropertyValues } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { BaseElement } from '../../primitives/base-element.js';\nimport { PixelDataController } from './pixel-data-controller.js';\nimport { animatePixels } from './animate-pixels.js';\nimport type { PixelDataType } from './pixel-data-controller.js';\nimport type { PixelTransition } from './animate-pixels.js';\nimport '../../atoms/pixel-display/bh-pixel-display.js';\nimport '../../molecules/card/bh-card.js';\n\n/**\n * Panel chrome that wraps a pixel display with header (label + value) and footer.\n *\n * **Dual mode:**\n * - **Slot mode** (default): Set `cols` and `rows` to 0. Slot a `<bh-pixel-display>` yourself.\n * - **Managed mode**: Set `cols` and `rows` > 0. The panel renders its own display,\n *   handles buffering, grid generation, and visual transitions.\n *\n * @slot - Display area (slot mode only; hidden in managed mode)\n * @slot label - Custom label content (overrides `label` prop)\n * @slot value - Custom value content (overrides `value` prop)\n * @slot footer-start - Custom footer-start content (overrides `footerStart` prop)\n * @slot footer-end - Custom footer-end content (overrides `footerEnd` prop)\n *\n * @csspart panel - The outer panel container\n * @csspart header - The header row\n * @csspart label - The label text\n * @csspart value - The value text\n * @csspart body - The display area wrapper\n * @csspart footer - The footer row\n *\n * @cssprop [--bh-pixel-panel-bg=var(--bh-color-surface)] - Panel background\n * @cssprop [--bh-pixel-panel-border=var(--bh-color-border)] - Panel border color\n * @cssprop [--bh-pixel-panel-radius=var(--bh-radius-lg)] - Panel border-radius\n */\n@customElement('bh-pixel-panel')\nexport class BhPixelPanel extends BaseElement {\n  static styles = [\n    ...([BaseElement.styles].flat()),\n    css`\n      :host {\n        display: inline-block;\n      }\n\n      bh-card {\n        --bh-card-bg: var(--bh-pixel-panel-bg, var(--bh-color-surface));\n        --bh-card-border: var(--bh-pixel-panel-border, var(--bh-color-border));\n        --bh-card-radius: var(--bh-pixel-panel-radius, var(--bh-radius-lg));\n        --bh-card-shadow: none;\n      }\n\n      .header {\n        display: flex;\n        align-items: baseline;\n        justify-content: space-between;\n        gap: var(--bh-spacing-2);\n        padding: var(--bh-spacing-2) var(--bh-spacing-3);\n      }\n\n      .label {\n        font-family: var(--bh-font-mono);\n        font-size: var(--bh-text-2xs);\n        font-weight: var(--bh-font-semibold);\n        letter-spacing: var(--bh-tracking-wider);\n        text-transform: uppercase;\n        color: var(--bh-color-text-muted);\n      }\n\n      .value {\n        font-family: var(--bh-font-mono);\n        font-size: var(--bh-text-2xs);\n        font-weight: var(--bh-font-semibold);\n        color: var(--bh-color-text);\n      }\n\n      .body {\n        padding: 0 var(--bh-spacing-3) var(--bh-spacing-2);\n      }\n\n      .footer {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        gap: var(--bh-spacing-2);\n        padding: var(--bh-spacing-1-5) var(--bh-spacing-3);\n        border-top: var(--bh-border-1) solid var(--bh-color-border-muted);\n        font-family: var(--bh-font-mono);\n        font-size: var(--bh-text-2xs);\n        color: var(--bh-color-text-muted);\n      }\n    `,\n  ];\n\n  @property() label = '';\n  @property() value = '';\n  @property({ attribute: 'footer-start' }) footerStart = '';\n  @property({ attribute: 'footer-end' }) footerEnd = '';\n\n  /** Grid width. Set > 0 along with `rows` to enable managed mode. */\n  @property({ type: Number }) cols = 0;\n\n  /** Grid height. Set > 0 along with `cols` to enable managed mode. */\n  @property({ type: Number }) rows = 0;\n\n  /** Data visualization type (managed mode). */\n  @property() type: PixelDataType = 'sparkline';\n\n  /** Visual transition mode (managed mode). */\n  @property() transition: PixelTransition = 'step';\n\n  /** Max frames per second for the transition directive (managed mode). */\n  @property({ type: Number }) fps = 12;\n\n  /** Palette index for lit pixels (managed mode). */\n  @property({ type: Number }) color = 1;\n\n  /** Rolling buffer size. Defaults to `cols` when 0. */\n  @property({ type: Number, attribute: 'buffer-size' }) bufferSize = 0;\n\n  private _ctrl?: PixelDataController;\n\n  private get _managed(): boolean {\n    return this.cols > 0 && this.rows > 0;\n  }\n\n  protected willUpdate(changed: PropertyValues): void {\n    if (!this._managed) return;\n\n    if (!this._ctrl) {\n      this._ctrl = new PixelDataController(this, {\n        cols: this.cols,\n        rows: this.rows,\n        type: this.type,\n        color: this.color,\n        bufferSize: this.bufferSize || this.cols,\n      });\n    } else if (\n      changed.has('cols') ||\n      changed.has('rows') ||\n      changed.has('type') ||\n      changed.has('color') ||\n      changed.has('bufferSize')\n    ) {\n      this._ctrl.configure({\n        cols: this.cols,\n        rows: this.rows,\n        type: this.type,\n        color: this.color,\n        bufferSize: this.bufferSize || this.cols,\n      });\n    }\n  }\n\n  push(value: number): void {\n    this._ctrl?.push(value);\n  }\n\n  set(values: number[]): void {\n    this._ctrl?.set(values);\n  }\n\n  setText(text: string): void {\n    this._ctrl?.setText(text);\n  }\n\n  setGrid(grid: Uint8Array): void {\n    this._ctrl?.setGrid(grid);\n  }\n\n  private _renderDisplay() {\n    return html`\n      <bh-pixel-display\n        .cols=${this.cols}\n        .rows=${this.rows}\n        .data=${animatePixels(this._ctrl!.grid, {\n          transition: this.transition,\n          fps: this.fps,\n          cols: this.cols,\n        })}\n        label=${this.label}\n      ></bh-pixel-display>\n    `;\n  }\n\n  render() {\n    return html`\n      <bh-card class=\"panel\" part=\"panel\" variant=\"outlined\" padding=\"none\" role=\"group\" aria-label=${this.label || 'panel'}>\n        <div class=\"header\" part=\"header\">\n          <span class=\"label\" part=\"label\"><slot name=\"label\">${this.label}</slot></span>\n          <span class=\"value\" part=\"value\"><slot name=\"value\">${this.value}</slot></span>\n        </div>\n        <div class=\"body\" part=\"body\">\n          ${this._managed ? this._renderDisplay() : html`<slot></slot>`}\n        </div>\n        <div class=\"footer\" part=\"footer\">\n          <span><slot name=\"footer-start\">${this.footerStart}</slot></span>\n          <span><slot name=\"footer-end\">${this.footerEnd}</slot></span>\n        </div>\n      </bh-card>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'bh-pixel-panel': BhPixelPanel;\n  }\n}\n"],"names":["BhPixelPanel","BaseElement","changed","PixelDataController","value","_a","values","text","grid","html","animatePixels","css","__decorateClass","property","customElement"],"mappings":"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"}