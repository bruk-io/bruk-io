{"version":3,"file":"bh-form-field.js","sources":["../../../src/molecules/form-field/bh-form-field.ts"],"sourcesContent":["import { html, css, nothing } from 'lit';\nimport { customElement, property, query } from 'lit/decorators.js';\nimport { BaseElement } from '../../primitives/base-element.js';\n\nlet nextId = 0;\n\n/**\n * Wraps any form atom with a label, help text, and error message.\n * Handles ARIA linking across Shadow DOM boundaries.\n *\n * @slot - The form control (e.g. `<bh-input>`, `<bh-select>`)\n *\n * @csspart field - The outer wrapper\n * @csspart label - The label element\n * @csspart help-text - The help text element\n * @csspart error - The error message element\n *\n * @cssprop [--bh-form-field-gap=var(--bh-spacing-1-5)] - Gap between label, control, and messages\n * @cssprop [--bh-form-field-label-color=var(--bh-color-text)] - Label text color\n * @cssprop [--bh-form-field-error-color=var(--bh-color-danger)] - Error text color\n */\n@customElement('bh-form-field')\nexport class BhFormField extends BaseElement {\n  static styles = [\n    ...([BaseElement.styles].flat()),\n    css`\n      :host {\n        display: block;\n      }\n\n      .field {\n        display: flex;\n        flex-direction: column;\n        gap: var(--bh-form-field-gap, var(--bh-spacing-1-5));\n      }\n\n      label {\n        font-family: var(--bh-font-sans);\n        font-size: var(--bh-text-sm);\n        font-weight: var(--bh-font-medium);\n        line-height: var(--bh-leading-normal);\n        color: var(--bh-form-field-label-color, var(--bh-color-text));\n      }\n\n      .required-marker {\n        color: var(--bh-form-field-error-color, var(--bh-color-danger));\n        margin-left: var(--bh-spacing-0-5);\n      }\n\n      .help-text {\n        font-family: var(--bh-font-sans);\n        font-size: var(--bh-text-sm);\n        line-height: var(--bh-leading-normal);\n        color: var(--bh-color-text-muted);\n      }\n\n      .error {\n        font-family: var(--bh-font-sans);\n        font-size: var(--bh-text-sm);\n        line-height: var(--bh-leading-normal);\n        color: var(--bh-form-field-error-color, var(--bh-color-danger));\n      }\n    `,\n  ];\n\n  @property() label = '';\n  @property({ attribute: 'help-text' }) helpText = '';\n  @property() error = '';\n  @property({ type: Boolean }) required = false;\n\n  @query('slot:not([name])') private _defaultSlot!: HTMLSlotElement;\n\n  private _uniqueId = `bh-ff-${++nextId}`;\n\n  render() {\n    const labelId = `${this._uniqueId}-label`;\n    const helpId = `${this._uniqueId}-help`;\n    const errorId = `${this._uniqueId}-error`;\n\n    return html`\n      <div class=\"field\" part=\"field\">\n        ${this.label\n          ? html`<label id=${labelId} part=\"label\">\n              ${this.label}${this.required ? html`<span class=\"required-marker\" aria-hidden=\"true\">*</span>` : nothing}\n            </label>`\n          : nothing}\n        <slot @slotchange=${this._onSlotChange}></slot>\n        ${this.helpText && !this.error\n          ? html`<div id=${helpId} class=\"help-text\" part=\"help-text\">${this.helpText}</div>`\n          : nothing}\n        ${this.error\n          ? html`<div id=${errorId} class=\"error\" part=\"error\" role=\"alert\">${this.error}</div>`\n          : nothing}\n      </div>\n    `;\n  }\n\n  updated() {\n    this._linkAria();\n  }\n\n  private _onSlotChange() {\n    this._linkAria();\n  }\n\n  private _linkAria() {\n    if (!this._defaultSlot) return;\n\n    const assigned = this._defaultSlot.assignedElements({ flatten: true });\n    if (assigned.length === 0) return;\n\n    const control = assigned[0] as HTMLElement;\n\n    const labelId = `${this._uniqueId}-label`;\n    const helpId = `${this._uniqueId}-help`;\n    const errorId = `${this._uniqueId}-error`;\n\n    // aria-labelledby\n    if (this.label) {\n      control.setAttribute('aria-labelledby', labelId);\n    } else {\n      control.removeAttribute('aria-labelledby');\n    }\n\n    // aria-describedby\n    if (this.error) {\n      control.setAttribute('aria-describedby', errorId);\n    } else if (this.helpText) {\n      control.setAttribute('aria-describedby', helpId);\n    } else {\n      control.removeAttribute('aria-describedby');\n    }\n\n    // aria-invalid\n    if (this.error) {\n      control.setAttribute('aria-invalid', 'true');\n    } else {\n      control.removeAttribute('aria-invalid');\n    }\n\n    // aria-required\n    if (this.required) {\n      control.setAttribute('aria-required', 'true');\n    } else {\n      control.removeAttribute('aria-required');\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'bh-form-field': BhFormField;\n  }\n}\n"],"names":["nextId","BhFormField","BaseElement","labelId","helpId","errorId","html","nothing","assigned","control","css","__decorateClass","property","query","customElement"],"mappings":";;;;;;;;AAIA,IAAIA,IAAS,GAkBAC,IAAN,cAA0BC,EAAY;AAAA,EAAtC,cAAA;AAAA,UAAA,GAAA,SAAA,GA2CO,KAAA,QAAQ,IACkB,KAAA,WAAW,IACrC,KAAA,QAAQ,IACS,KAAA,WAAW,IAIxC,KAAQ,YAAY,SAAS,EAAEF,CAAM;AAAA,EAAA;AAAA,EAErC,SAAS;AACP,UAAMG,IAAU,GAAG,KAAK,SAAS,UAC3BC,IAAS,GAAG,KAAK,SAAS,SAC1BC,IAAU,GAAG,KAAK,SAAS;AAEjC,WAAOC;AAAA;AAAA,UAED,KAAK,QACHA,cAAiBH,CAAO;AAAA,gBACpB,KAAK,KAAK,GAAG,KAAK,WAAWG,+DAAkEC,CAAO;AAAA,wBAE1GA,CAAO;AAAA,4BACS,KAAK,aAAa;AAAA,UACpC,KAAK,YAAY,CAAC,KAAK,QACrBD,YAAeF,CAAM,uCAAuC,KAAK,QAAQ,WACzEG,CAAO;AAAA,UACT,KAAK,QACHD,YAAeD,CAAO,4CAA4C,KAAK,KAAK,WAC5EE,CAAO;AAAA;AAAA;AAAA,EAGjB;AAAA,EAEA,UAAU;AACR,SAAK,UAAA;AAAA,EACP;AAAA,EAEQ,gBAAgB;AACtB,SAAK,UAAA;AAAA,EACP;AAAA,EAEQ,YAAY;AAClB,QAAI,CAAC,KAAK,aAAc;AAExB,UAAMC,IAAW,KAAK,aAAa,iBAAiB,EAAE,SAAS,IAAM;AACrE,QAAIA,EAAS,WAAW,EAAG;AAE3B,UAAMC,IAAUD,EAAS,CAAC,GAEpBL,IAAU,GAAG,KAAK,SAAS,UAC3BC,IAAS,GAAG,KAAK,SAAS,SAC1BC,IAAU,GAAG,KAAK,SAAS;AAGjC,IAAI,KAAK,QACPI,EAAQ,aAAa,mBAAmBN,CAAO,IAE/CM,EAAQ,gBAAgB,iBAAiB,GAIvC,KAAK,QACPA,EAAQ,aAAa,oBAAoBJ,CAAO,IACvC,KAAK,WACdI,EAAQ,aAAa,oBAAoBL,CAAM,IAE/CK,EAAQ,gBAAgB,kBAAkB,GAIxC,KAAK,QACPA,EAAQ,aAAa,gBAAgB,MAAM,IAE3CA,EAAQ,gBAAgB,cAAc,GAIpC,KAAK,WACPA,EAAQ,aAAa,iBAAiB,MAAM,IAE5CA,EAAQ,gBAAgB,eAAe;AAAA,EAE3C;AACF;AA7HaR,EACJ,SAAS;AAAA,EACd,GAAI,CAACC,EAAY,MAAM,EAAE,KAAA;AAAA,EACzBQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsCF;AAEYC,EAAA;AAAA,EAAXC,EAAA;AAAS,GA3CCX,EA2CC,WAAA,SAAA,CAAA;AAC0BU,EAAA;AAAA,EAArCC,EAAS,EAAE,WAAW,YAAA,CAAa;AAAA,GA5CzBX,EA4C2B,WAAA,YAAA,CAAA;AAC1BU,EAAA;AAAA,EAAXC,EAAA;AAAS,GA7CCX,EA6CC,WAAA,SAAA,CAAA;AACiBU,EAAA;AAAA,EAA5BC,EAAS,EAAE,MAAM,QAAA,CAAS;AAAA,GA9ChBX,EA8CkB,WAAA,YAAA,CAAA;AAEMU,EAAA;AAAA,EAAlCE,EAAM,kBAAkB;AAAA,GAhDdZ,EAgDwB,WAAA,gBAAA,CAAA;AAhDxBA,IAANU,EAAA;AAAA,EADNG,EAAc,eAAe;AAAA,GACjBb,CAAA;"}